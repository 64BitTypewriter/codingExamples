#! /usr/bin/env python
import numpy as np
from math import exp, sqrt

# Create an array and fill it with data from file (array[row][column])
data = np.genfromtxt("Digitalized/runjobh.dat")
n_rows = data.shape[0]
n_columns = data.shape[1]
newdata = np.empty(shape=[n_rows,n_columns])

# Define GSHL parameters and formula
a = 14900
b = 2.15
c = -0.22
d = 2.74
def gshl(x):
    return a*(x + b*exp(c*sqrt(x)))**(-d)

# Convert digitalized (deviations) into flux
for i in range(0, n_rows):
    newdata[i][0] = data[i][0]
    newdata[i][1] = gshl(data[i][0])*(1 + data[i][1]/100.)
    newdata[i][2] = gshl(data[i][0])*(1 + data[i][2]/100.)
    newdata[i][3] = gshl(data[i][0])*(1 + data[i][3]/100.)

print data
print newdata
